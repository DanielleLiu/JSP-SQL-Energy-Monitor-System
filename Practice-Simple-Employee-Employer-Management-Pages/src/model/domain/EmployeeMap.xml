<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"

    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="sbzy.enterpriseems.model.domain.Employee">
<!-- 本地property,SQLcolumn -->
    <resultMap type="employee" id="EmployeeMap">
        <id property="id" column="ID"/>
        <result property="pid" column="PID"/>
        <result property="code" column="Code"/>
        <result property="name" column="Name" />
		<result property="sex" column="Sex" />
	<association property="parent" column="PID" select="selectByPid">
    <id property="ID" column="ID"/>
        <result property="pid" column="PID"/>
        <result property="name" column="Name"/>
        <result property="sex" column="Sex" />
        <result property="code" column="Code"/>
   </association>
    </resultMap>

<select id="selectByPid" resultType="employee" parameterType="int">
	select * from Employee where ID=#{pid}
</select>

    
      
<insert id="insert" parameterType="employee" >
	INSERT INTO Employee (PID,Code,Name,Sex) 
	VALUES (#{pid},#{code},#{name},#{sex})
</insert>

<update id="update" parameterType="employee">
	UPDATE Employee SET
 	PID=#{pid},Code=#{code},Name=#{name},Sex=#{sex}
 	WHERE ID=#{id}
</update>


<delete id="delete" parameterType="int"> 
	DELETE FROM Employee WHERE ID=#{id};
</delete>
<!-- 根据用户编号删除，所有信息删除？ parameterType java.util.HashMap?  -->


<!-- 得到一条数据根据ID-->
    <select id="selectOneRecord" resultMap="EmployeeMap" parameterType="int">
   <![CDATA[
            select * from Employee where ID=#{id}
        ]]> <!-- CDATA会被解析器忽略，文本包含很多特殊字符放入CDATA -->
    </select>
  
<!-- 得到全部记录 -->
    <select id="selectList" resultMap="EmployeeMap">
            select * from Employee where 1=1
            <if test="searchname !=null and searchname!=''">
            AND Name LIKE '%'+#{searchname}+'%'
            </if>
            <if test="code !=null and code!=''">
            AND Code LIKE '%'+#{code}+'%'
            </if>
            <if test="pid !=null and pid!=''">
            AND PID = pid
            </if>
    </select>

<!-- 条件查询,得到多条记录 可查询项目：可查询attribute:name,code,sex -->
    <select id="selectListByWhere" resultMap="EmployeeMap" parameterType="java.util.HashMap">
        select * from Employee
         <where>
            <if test="id != null and id != '' ">
            AND ID = #{id}
            </if>
            <if test="pid != null and pid != '' ">
			AND PID = #{pid}            
            </if>
            <if test="name !=null and name!=''">
            AND Name LIKE '%'+#{name}+'%'
            </if>
            <if test="sex !=null and sex!=''">
            AND Sex=#{sex}
            </if>
            <if test="code !=null and code!=''">
            AND Code LIKE '%'+#{code}+'%'
            </if>
        </where>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
    </select>

    <select id="selectChildrenList" resultMap="EmployeeMap">
            select * from Employee where 
            PID IN (SELECT ID FROM Employee
            <where>
            <if test="parentName !=null and parentName!=''">
            Name LIKE '%'+#{parentName}+'%'
            </if>
            </where>
            )
       
     </select>

</mapper>